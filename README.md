# BOF24 - The Bag of Flows'24 Malware Dataset

The BOF24 dataset is a collection of network traffic data, created by analysing over 1.5 million samples of malware and benignware. The BOF24 dataset is meant to serve as a benchmark for researchers, especially for those designing systems that utlise ML/DL techniques given the unique properties of this dataset. This repository makes it easy to download this data, reproducibly train and benchmark new models, extend the feature set, or classify new malware using the data provided.

We provide a brief overview of the dataset below. For further details, please consult the paper: <https://ieeexplore.ieee.org/document/10225000>.

## Details

As the name suggests, the data in BOF24 is in the form of a data representation we call Bag of Flows (BoF). Each BoF corresponds to the NetFlow data generated by a given sample in our collection. The features of the NetFlows in this dataset are further augmented by TTP features, which correspond to the Tactics, Techniques, and Procedures (TTPs) from the MITRE ATT&CK framework. We generate these using our TTP Detection Engine - see this [paper](https://dl.acm.org/doi/10.1145/3590777.3590804) for further details. Finally, they contain a binary label which differentiates benign samples (`0`) from malicious ones (`1`).

We have designed this dataset with certain properties in mind:
1. It contains 5 equal-sized datasets to allow for multiple runs.
2. It contains malware from a variety of sources to increase diversity.
3. The individual datasets are balanced between malware and benignware, to create ideal conditions for training ML/DL models.

Each individual dataset within BOF24 is also pre-divided into training sets (`train.csv`), validation sets (`val.csv`), and testing sets (`test.csv`) for further ease of use. The division of the data between training, validation, and testing is 60:20:20. 

## Citing

If you use this data in a publication please cite the following papers:

```
Y. Sharma, E. Giunchiglia, S. Birnbach and I. Martinovic, "To TTP or not to TTP?: Exploiting TTPs to Improve ML-based Malware Detection," 2023 IEEE International Conference on Cyber Security and Resilience (CSR), Venice, Italy, 2023, pp. 8-15, doi: 10.1109/CSR57506.2023.10225000.

@INPROCEEDINGS{10225000,
  author={Sharma, Yashovardhan and Giunchiglia, Eleonora and Birnbach, Simon and Martinovic, Ivan},
  booktitle={2023 IEEE International Conference on Cyber Security and Resilience (CSR)}, 
  title={To TTP or not to TTP?: Exploiting TTPs to Improve ML-based Malware Detection}, 
  year={2023},
  volume={},
  number={},
  pages={8-15},
  keywords={Training;Measurement;Telecommunication traffic;Machine learning;Malware;Data models;Task analysis;Malware;Machine Learning;Intrusion Detection;MITRE ATT&CK;Networks},
  doi={10.1109/CSR57506.2023.10225000}}

```

```
@inproceedings{10.1145/3590777.3590804,
author = {Sharma, Yashovardhan and Birnbach, Simon and Martinovic, Ivan},
title = {RADAR: A TTP-based Extensible, Explainable, and Effective System for Network Traffic Analysis and Malware Detection},
year = {2023},
isbn = {9781450398299},
publisher = {Association for Computing Machinery},
address = {New York, NY, USA},
url = {https://doi.org/10.1145/3590777.3590804},
doi = {10.1145/3590777.3590804},
booktitle = {Proceedings of the 2023 European Interdisciplinary Cybersecurity Conference},
pages = {159â€“166},
numpages = {8},
keywords = {Cyber Security, Explainable AI, Malware, Network Analysis},
location = {Stavanger, Norway},
series = {EICC '23}
}
```
